<script>
    document.addEventListener('DOMContentLoaded', () => {
        const container = document.getElementById('main-container');
        const copyButton = document.getElementById('copy-btn');
        const form = document.getElementById('medicalHistoryForm');
        const copyContainer = document.getElementById('copy-container');
        const reportOutput = document.getElementById('report-output');
        const allInputs = () => form.querySelectorAll('input, select, textarea');
        const STORAGE_KEY = 'medicalHistoryState';

        // --- –î–∞–Ω–Ω—ã–µ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ ---
        const conditions = [
            {id: 'cond_1', text: '1. –ê–ª–ª–µ—Ä–≥–∏—è'}, {id: 'cond_11', text: '11. –Ø–∑–≤–∞'}, {id: 'cond_21', text: '21. –ü–æ—Ç–µ—Ä—è —Å–æ–∑–Ω–∞–Ω–∏—è'},
            {id: 'cond_2', text: '2. –ü–æ—Ç–µ—Ä—è —Å–ª—É—Ö–∞'}, {id: 'cond_12', text: '12. –°–µ—Ä–¥–µ—á–Ω—ã–π –ø—Ä–∏—Å—Ç—É–ø'}, {id: 'cond_22', text: '22. –≠–ø–∏–ª–µ–ø—Å–∏—è'},
            {id: 'cond_3', text: '3. –ê—Å—Ç–º–∞'}, {id: 'cond_13', text: '13. –®—É–º –≤ —Å–µ—Ä–¥—Ü–µ'}, {id: 'cond_23', text: '23. –ö–æ–Ω–≤—É–ª—å—Å–∏–∏'},
            {id: 'cond_4', text: '4. –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–æ—á–µ–∫'}, {id: 'cond_14', text: '14. –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π —Å—Ç—Ä–µ—Å—Å-—Ç–µ—Å—Ç'}, {id: 'cond_24', text: '24. –ò–Ω—Å—É–ª—å—Ç'},
            {id: 'cond_5', text: '5. –ü—Ä–æ—Å—Ç–∞—Ç–∏—Ç'}, {id: 'cond_15', text: '15. –ü–∞—Ç–æ–ª–æ–≥–∏–∏ —Å–µ—Ä–¥–µ—á–Ω–æ–≥–æ –∫–ª–∞–ø–∞–Ω–∞'}, {id: 'cond_25', text: '25. –î–∏–∞–±–µ—Ç'},
            {id: 'cond_6', text: '6. –ö–æ–ª–∏—Ç'}, {id: 'cond_16', text: '16. –ê–Ω–≥–∏–Ω–∞'}, {id: 'cond_26', text: '26. –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã'},
            {id: 'cond_7', text: '7. –ì–µ–ø–∞—Ç–∏—Ç'}, {id: 'cond_17', text: '17. –°–µ—Ä–¥–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å'}, {id: 'cond_27', text: '27. –ê–Ω–µ–º–∏—è'},
            {id: 'cond_8', text: '8. –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –ø–µ—á–µ–Ω–∏'}, {id: 'cond_18', text: '18. –í—ã—Å–æ–∫–∏–π —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'}, {id: 'cond_28', text: '28. –≠–∫–∑–µ–º–∞'},
            {id: 'cond_9', text: '9. –ü–æ–≤—ã—à–µ–Ω–Ω—ã–µ —Ñ–µ—Ä–º–µ–Ω—Ç—ã –ø–µ—á–µ–Ω–∏'}, {id: 'cond_19', text: '19. –í—ã—Å–æ–∫–æ–µ –∫—Ä–æ–≤—è–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ'}, {id: 'cond_29', text: '29. –û–Ω–∫–æ–ª–æ–≥–∏—è'},
            {id: 'cond_10', text: '10. –ü–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç'}, {id: 'cond_20', text: '20. –ê—Ä—Ç—Ä–∏—Ç/–†–µ–≤–º–∞—Ç–∏–∑–º'}, {id: 'cond_30', text: '30. –ê–ø–Ω–æ—ç'}
        ];
        const symptoms = [
            {id: 'symp_31', text: '31. –ù–∞—Ä—É—à–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è –Ω–æ—á—å—é'}, {id: 'symp_40', text: '40. –û–¥—ã—à–∫–∞'}, {id: 'symp_45', text: '45. –ë–æ–ª–µ–∑–Ω—å –º–æ—á–µ–≤–æ–≥–æ –ø—É–∑—ã—Ä—è'},
            {id: 'symp_32', text: '32. –ò–∑–º–µ–Ω–µ–Ω–∏—è –∑—Ä–µ–Ω–∏—è'}, {id: 'symp_41', text: '41. –•—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π –∫–∞—à–µ–ª—å'}, {id: 'symp_46', text: '46. –ö—Ä–æ–≤—å –≤ –º–æ—á–µ'},
            {id: 'symp_33', text: '33. –†–∞–∑–º—ã—Ç–æ–µ –∑—Ä–µ–Ω–∏–µ'}, {id: 'symp_42', text: '42. –ú–æ–∫—Ä–æ—Ç–∞ —Å –∫—Ä–æ–≤—å—é'}, {id: 'symp_47', text: '47. –ù–µ—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏–µ'},
            {id: 'symp_34', text: '34. –ö—Ä–æ–≤–æ—Ç–æ—á–∏–≤–æ—Å—Ç—å –¥–µ—Å–µ–Ω'}, {id: 'symp_43', text: '43. –°—Ç–µ—Å–Ω–µ–Ω–∏–µ –≤ –≥—Ä—É–¥–∏'}, {id: 'symp_48', text: '48. –¢–µ–∫—É—â–∞—è –±–µ—Ä–µ–º–µ–Ω–Ω–æ—Å—Ç—å'},
            {id: 'symp_35', text: '35. –ö—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è –∏–∑ –Ω–æ—Å–∞'}, {id: 'symp_44', text: '44. –°–æ–ø–µ–Ω–∏–µ'}, {id: 'symp_49', text: '49. –ó–∞—Ç—Ä—É–¥–Ω–µ–Ω–∏–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏—è'},
            {id: 'symp_36', text: '36. –ß–∞—Å—Ç—ã–π –≥–∞–π–º–æ—Ä–∏—Ç'}, {id: 'symp_53', text: '53. –†–≤–æ—Ç–∞ –∫—Ä–æ–≤—å—é'}, {id: 'symp_50', text: '50. –ú–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ >7 —Ä–∞–∑/–¥–µ–Ω—å'},
            {id: 'symp_37', text: '37. –û—Ö—Ä–∏–ø–ª–æ—Å—Ç—å'}, {id: 'symp_54', text: '54. –î–ª–∏—Ç–µ–ª—å–Ω—ã–π –ø–æ–Ω–æ—Å'}, {id: 'symp_51', text: '51. –ß–∞—Å—Ç–æ–µ/–±–æ–ª–µ–∑–Ω–µ–Ω–Ω–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ'},
            {id: 'symp_38', text: '38. –®—É–º –≤ —É—à–∞—Ö'}, {id: 'symp_55', text: '55. –î–ª–∏—Ç–µ–ª—å–Ω—ã–π –∑–∞–ø–æ—Ä'}, {id: 'symp_52', text: '52. –ü–æ–ª–æ–≤–∞—è –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏—è'},
            {id: 'symp_39', text: '39. –ë–æ–ª—å –≤ —É—à–∞—Ö'}, {id: 'symp_56', text: '56. –ß–∞—Å—Ç–∞—è –±–æ–ª—å –≤ –∂–∏–≤–æ—Ç–µ'}, {id: 'symp_63', text: '63. –û–±–º–æ—Ä–æ–∫'},
            {id: 'symp_57', text: '57. –ß–∞—Å—Ç–∞—è —Ä–≤–æ—Ç–∞'}, {id: 'symp_64', text: '64. –ì–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏–µ'}, {id: 'symp_71', text: '71. –°–∏–ª—å–Ω–æ–µ/–Ω–µ—Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–µ'},
            {id: 'symp_58', text: '58. –ß–∞—Å—Ç–∞—è –∏–∑–∂–æ–≥–∞'}, {id: 'symp_65', text: '65. –ß–∞—Å—Ç—ã–µ –≥–æ–ª–æ–≤–Ω—ã–µ –±–æ–ª–∏'}, {id: 'symp_72', text: '72. –ë–æ–ª—å –≤ –≥—Ä—É–¥–∏'},
            {id: 'symp_59', text: '59. –ö–∞–ª —Å –∫—Ä–æ–≤—å—é'}, {id: 'symp_66', text: '66. –¢—Ä–µ–º–æ—Ä'}, {id: 'symp_73', text: '73. –í—ã—Å–æ–∫–∏–π —Ö–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω'},
            {id: 'symp_60', text: '60. –ì–µ–º–æ—Ä—Ä–æ–π'}, {id: 'symp_67', text: '67. –ü–æ—Ç–µ—Ä—è –ø–∞–º—è—Ç–∏'}, {id: 'symp_74', text: '74. –ü–æ—Ç–µ–Ω–∏–µ —Å—Ç—É–ø–Ω–µ–π'},
            {id: 'symp_61', text: '61. –ü—Ä–æ–±–ª–µ–º—ã —Å –≥–ª–æ—Ç–∞–Ω–∏–µ–º'}, {id: 'symp_68', text: '68. –ü–æ—Ç–µ—Ä—è –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏'}, {id: 'symp_75', text: '75. –ë–æ–ª—å –≤ –Ω–æ–≥–∞—Ö –ø—Ä–∏ —Ö–æ–¥—å–±–µ'},
            {id: 'symp_62', text: '62. –ì—Ä—ã–∂–∞ –≤ –ñ–ö–¢'}, {id: 'symp_69', text: '69. –¢—Ä—É–¥–Ω–æ—Å—Ç—å –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏'}, {id: 'symp_76', text: '76. –í–∞—Ä–∏–∫–æ–∑–Ω—ã–µ –≤–µ–Ω—ã'},
            {id: 'symp_77', text: '77. –ü—Ä–æ–±–ª–µ–º—ã/–ë–æ–ª—å –≤ —Å–ø–∏–Ω–µ'}, {id: 'symp_70', text: '70. –û–Ω–µ–º–µ–Ω–∏–µ/–ü–æ–∫–∞–ª—ã–≤–∞–Ω–∏–µ'}, {id: 'symp_81', text: '81. –õ–µ–≥–∫–æ –ø–æ–ª—É—á–∞–µ–º—ã–µ —Å–∏–Ω—è–∫–∏'},
            {id: 'symp_78', text: '78. –ü—Ä–æ–±–ª–µ–º—ã/–ë–æ–ª—å –≤ —à–µ–µ'}, {id: 'symp_82', text: '82. –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ –≥–ª–∞–Ω–¥—ã'}, {id: 'symp_86', text: '86. –ù–æ—á–Ω–∞—è –ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å'},
            {id: 'symp_79', text: '79. –¢—Ä–∞–≤–º–∞/–ë–æ–ª—å –≤ —Å—É—Å—Ç–∞–≤–µ'}, {id: 'symp_83', text: '83. –°—ã–ø—å'}, {id: 'symp_87', text: '87. –ë–µ—Å–ø—Ä–∏—á–∏–Ω–Ω–∞—è –ø–æ—Ç–µ—Ä—è –≤–µ—Å–∞'},
            {id: 'symp_80', text: '80. –¢—É–Ω–Ω–µ–ª—å–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º'}, {id: 'symp_84', text: '84. –ù–µ–æ–±—ä—è—Å–Ω–∏–º—ã–µ —à–∏—à–∫–∏'}, {id: 'symp_88', text: '88. –•—Ä–∞–ø'},
            {id: 'symp_85', text: '85. –•—Ä–æ–Ω–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–ª–æ—Å—Ç—å'}, {id: 'symp_89', text: '89. –ü—Ä–æ–±–ª–µ–º—ã —Å–æ —Å–Ω–æ–º'}, {id: 'symp_90', text: '90. –ù–∏–∑–∫–∏–π —É—Ä–æ–≤–µ–Ω—å —Å–∞—Ö–∞—Ä–∞'}
        ];
        
        // --- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö –ø–æ–ª–µ–π ---
        const generateCheckboxes = (containerId, items) => {
            const container = document.getElementById(containerId);
            if (!container) return;
            let html = '';
            items.forEach(item => {
                html += `<label class="flex items-center cursor-pointer"><input type="checkbox" id="${item.id}" name="${item.id}" class="form-checkbox mr-3"><span class="flex-1 text-sm">${item.text}</span></label>`;
            });
            container.innerHTML = html;
        };
        
        const generateLifestyleQuestions = () => {
            const container = document.getElementById('lifestyle-questions');
            if (!container) return;
            const questionsHTML = `
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">91. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –ª–∏ –≤—ã –∫–∞–∫–∏–µ-–ª–∏–±–æ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞ –ø–æ —Ä–µ—Ü–µ–ø—Ç—É –∏–ª–∏ –±–µ–∑ —Ä–µ—Ü–µ–ø—Ç–∞?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="medication" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="medication" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">92. –ò–º–µ–ª–∏ –ª–∏ –≤—ã –∫–∞–∫–∏–µ-–ª–∏–±–æ —Ö–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ª–µ—Ç?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="surgery" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="surgery" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">93. –£ –∫–æ–≥–æ-–Ω–∏–±—É–¥—å –≤ –≤–∞—à–µ–π —Å–µ–º—å–µ —Ä–∞–∑–≤–∏–ª–∞—Å—å –±–æ–ª–µ–∑–Ω—å —Å–µ—Ä–¥—Ü–∞ –≤ –≤–æ–∑—Ä–∞—Å—Ç–µ –¥–æ 60 –ª–µ—Ç?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="family_heart_disease" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="family_heart_disease" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">94. –ï—Å—Ç—å –ª–∏ –∫–∞–∫–∏–µ-–ª–∏–±–æ –±–æ–ª–µ–∑–Ω–∏ –≤ –≤–∞—à–µ–π —Å–µ–º—å–µ?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="family_illness" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="family_illness" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">95. –ï—Å—Ç—å –ª–∏ —É –≤–∞—Å –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è –ø—Ä–æ—Å—Ç—É–¥–∞ / –∫–∞—à–µ–ª—å?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="cold_cough" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="cold_cough" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">96. –ë—ã–ª–∏ –ª–∏ –≤—ã –∫–æ–≥–¥–∞-–ª–∏–±–æ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="hospitalized" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="hospitalized" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">97. –°—Ç–æ–∏—Ç–µ –ª–∏ –≤—ã –≤ –¥–∞–Ω–Ω—ã–π –º–æ–º–µ–Ω—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —É—á–µ—Ç–µ —É –∫–∞–∫–æ–≥–æ-–ª–∏–±–æ –≤—Ä–∞—á–∞?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="doctor_care" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="doctor_care" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">98. –£ –≤–∞—Å –±—ã–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–∞–∑–º–µ—Ä–µ –∏–ª–∏ —Ü–≤–µ—Ç–µ —Ä–æ–¥–∏–Ω–∫–∏?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="mole_change" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="mole_change" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">99. –£ –≤–∞—Å –±—ã–ª–∏ –∫–∞–∫–∏–µ-–ª–∏–±–æ –±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–∞ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –≤–∞—à–µ–≥–æ –∑–¥–æ—Ä–æ–≤—å—è?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="health_concerns" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="health_concerns" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">100. –í—ã –∫—É—Ä–∏—Ç–µ –≤ –Ω–∞—Å—Ç–æ—è—â–∏–π –º–æ–º–µ–Ω—Ç?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="smoking_now" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="smoking_now" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                    <div class="mt-2 space-y-2 pl-6"><label for="cigarettes_per_day" class="text-sm">–ê. –°–∫–æ–ª—å–∫–æ —Å–∏–≥–∞—Ä–µ—Ç –≤ –¥–µ–Ω—å?</label><input type="text" id="cigarettes_per_day" name="cigarettes_per_day" class="form-input"><label for="smoking_duration_now" class="text-sm">–ë. –ö–∞–∫ –¥–æ–ª–≥–æ –≤—ã –∫—É—Ä–∏—Ç–µ?</label><input type="text" id="smoking_duration_now" name="smoking_duration_now" class="form-input"></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">101. –í—ã –∫—É—Ä–∏–ª–∏ –∫–æ–≥–¥–∞-–ª–∏–±–æ –≤ —Å–≤–æ–µ–π –∂–∏–∑–Ω–∏?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="smoked_ever" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="smoked_ever" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                    <div class="mt-2 space-y-2 pl-6"><label for="smoking_duration_past" class="text-sm">–ê. –°–∫–æ–ª—å–∫–æ –ª–µ—Ç –∫—É—Ä–∏–ª–∏:</label><input type="text" id="smoking_duration_past" name="smoking_duration_past" class="form-input"><label for="cigarettes_per_day_past" class="text-sm">–ë. –°–∫–æ–ª—å–∫–æ —Å–∏–≥–∞—Ä–µ—Ç –≤ –¥–µ–Ω—å?</label><input type="text" id="cigarettes_per_day_past" name="cigarettes_per_day_past" class="form-input"><label for="quit_date" class="text-sm">–í. –ö–æ–≥–¥–∞ –≤—ã –±—Ä–æ—Å–∏–ª–∏ –∫—É—Ä–∏—Ç—å?</label><input type="text" id="quit_date" name="quit_date" class="form-input"></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">102. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ª–∏ –≤—ã –¥—Ä—É–≥–∏–µ —Ñ–æ—Ä–º—ã —Ç–∞–±–∞–∫–∞ –∏–ª–∏ –Ω–∏–∫–æ—Ç–∏–Ω–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 15 –ª–µ—Ç?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="other_tobacco" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="other_tobacco" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">103. –ü—å–µ—Ç–µ –ª–∏ –≤—ã –ø–∏–≤–æ –∏–ª–∏ –¥—Ä—É–≥–∏–µ —Å–ª–∞–±–æ–∞–ª–∫–æ–≥–æ–ª—å–Ω—ã–µ –Ω–∞–ø–∏—Ç–∫–∏?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="alcohol" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="alcohol" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                    <div class="mt-2 pl-6"><label for="alcohol_amount" class="text-sm">–ü—å—é <input type="text" id="alcohol_amount" name="alcohol_amount" class="form-input inline-block w-20 mx-2"> –ª –≤ –Ω–µ–¥–µ–ª—é –ø–æ <input type="text" name="alcohol_days" id="alcohol_days" class="form-input inline-block w-32 mx-2"></label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">104. –í—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —É –≤–∞—Å –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–∂–∏?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="skin_condition" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="skin_condition" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">105. –í—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —É –≤–∞—Å –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–≥—Ç–µ–π?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="nail_condition" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="nail_condition" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">106. –í—ã —Å—á–∏—Ç–∞–µ—Ç–µ, —á—Ç–æ —É –≤–∞—Å –Ω–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ–ª–æ—Å?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="hair_condition" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="hair_condition" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">107. –ö–æ–≥–¥–∞ –≤—ã –¥–µ–ª–∞–ª–∏ –ø–æ—Å–ª–µ–¥–Ω–µ–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ?</label>
                    <div class="mt-2 space-y-2 pl-6">
                        <div class="flex items-center gap-2 flex-wrap"><span>–•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω:</span> <input type="date" name="cholesterol_date" id="cholesterol_date" class="form-input w-auto"> <span>–†–µ–∑—É–ª—å—Ç–∞—Ç:</span> <input type="text" name="cholesterol_result" id="cholesterol_result" class="form-input w-32"></div>
                        <div class="flex items-center gap-2 flex-wrap"><span>–ì–µ–º–∞—Ç–æ–∫—Ä–∏—Ç:</span> <input type="date" name="hematocrit_date" id="hematocrit_date" class="form-input w-auto"> <span>–†–µ–∑—É–ª—å—Ç–∞—Ç:</span> <input type="text" name="hematocrit_result" id="hematocrit_result" class="form-input w-32"></div>
                        <div class="flex items-center gap-2 flex-wrap"><span>–ì–µ–º–æ–≥–ª–æ–±–∏–Ω:</span> <input type="date" name="hemoglobin_date" id="hemoglobin_date" class="form-input w-auto"> <span>–†–µ–∑—É–ª—å—Ç–∞—Ç:</span> <input type="text" name="hemoglobin_result" id="hemoglobin_result" class="form-input w-32"></div>
                        <div class="flex items-center gap-2 flex-wrap"><span>–ì–ª—é–∫–æ–∑–∞:</span> <input type="date" name="glucose_date" id="glucose_date" class="form-input w-auto"> <span>–†–µ–∑—É–ª—å—Ç–∞—Ç:</span> <input type="text" name="glucose_result" id="glucose_result" class="form-input w-32"></div>
                        <div class="flex items-center gap-2 flex-wrap"><span>–ò–Ω—Å—É–ª–∏–Ω:</span> <input type="date" name="insulin_date" id="insulin_date" class="form-input w-auto"> <span>–†–µ–∑—É–ª—å—Ç–∞—Ç:</span> <input type="text" name="insulin_result" id="insulin_result" class="form-input w-32"></div>
                    </div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">108. –í–æ –≤—Ä–µ–º—è –µ–¥—ã —É –≤–∞—Å –±—ã–≤–∞—é—Ç —Ç—è–∂–µ—Å—Ç—å, –≤–∑–¥—É—Ç–∏–µ, –∏–∑–∂–æ–≥–∞?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="digestion_issues" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="digestion_issues" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">109. –í–∞—à–∞ —Ä–∞–±–æ—á–∞—è –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–≤—è–∑–∞–Ω–∞ —Å —Ö–∏–º–∏–µ–π, —à—É–º–æ–º –∏–ª–∏ –ø—ã–ª—å—é?</label>
                    <div class="flex space-x-4"><label class="flex items-center"><input type="radio" name="work_hazards" value="–î–∞" class="form-radio mr-2"> –î–∞</label><label class="flex items-center"><input type="radio" name="work_hazards" value="–ù–µ—Ç" class="form-radio mr-2"> –ù–µ—Ç</label></div>
                </div>
                <div class="question-group">
                    <label class="block text-sm font-medium text-gray-300 mb-2">110. –í–∞—à —Ç–µ–∫—É—â–∏–π —Ä–∞—Ü–∏–æ–Ω —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è –∫–∞–∫:</label>
                    <div class="flex flex-wrap gap-4"><label class="flex items-center"><input type="radio" name="diet_type" value="–ù–∏–∑–∫–æ–∂–∏—Ä–æ–≤–æ–π" class="form-radio mr-2"> –ù–∏–∑–∫–æ–∂–∏—Ä–æ–≤–æ–π</label><label class="flex items-center"><input type="radio" name="diet_type" value="–ù–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω—ã–π" class="form-radio mr-2"> –ù–∏–∑–∫–æ—É–≥–ª–µ–≤–æ–¥–Ω—ã–π</label><label class="flex items-center"><input type="radio" name="diet_type" value="–í—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤—ã–π" class="form-radio mr-2"> –í—ã—Å–æ–∫–æ–±–µ–ª–∫–æ–≤—ã–π</label><label class="flex items-center"><input type="radio" name="diet_type" value="–í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–π" class="form-radio mr-2"> –í–µ–≥–µ—Ç–∞—Ä–∏–∞–Ω—Å–∫–∏–π</label><label class="flex items-center"><input type="radio" name="diet_type" value="–ù–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏" class="form-radio mr-2"> –ù–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏</label></div>
                </div>
            `;
            container.innerHTML = questionsHTML;
        }
        
        function generateDetailsFields() {
            const container = document.getElementById('details-container');
            let html = '<label class="block text-sm font-medium text-gray-300 mb-2">–î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–æ–≤ "–î–∞":</label>';
            for(let i = 1; i <= 10; i++) {
                html += `
                    <div class="grid grid-cols-12 gap-2 items-center">
                        <div class="col-span-3">
                            <input type="number" name="detail_q_${i}" id="detail_q_${i}" min="1" max="110" placeholder="‚Ññ" class="form-input p-2 text-center">
                        </div>
                        <div class="col-span-9">
                            <input type="text" name="detail_text_${i}" id="detail_text_${i}" placeholder="–î–µ—Ç–∞–ª–∏..." class="form-input p-2">
                        </div>
                    </div>
                `;
            }
            container.innerHTML = html;
        }

        // --- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∑–∞–≥—Ä—É–∑–∫–∞ ---
        function saveState() {
            const state = {};
            allInputs().forEach(input => {
                const key = input.id || (input.name + input.value);
                if (input.type === 'checkbox' || input.type === 'radio') {
                    if (input.name && !input.id) { // –î–ª—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫
                         if(input.checked) state[input.name] = input.value;
                    } else {
                         state[key] = input.checked;
                    }
                } else {
                    state[input.id] = input.value;
                }
            });
            localStorage.setItem(STORAGE_KEY, JSON.stringify(state));
        }

        function loadState() {
            const savedState = localStorage.getItem(STORAGE_KEY);
            if (savedState) {
                const state = JSON.parse(savedState);
                allInputs().forEach(input => {
                    const key = input.id || (input.name + input.value);
                    if (state[key] !== undefined) {
                        if (input.type === 'checkbox') {
                            input.checked = state[key];
                        } else if (input.type === 'radio') {
                             if(state[input.name] === input.value) {
                                input.checked = true;
                            }
                        } else {
                            input.value = state[key];
                        }
                    } else if (input.type === 'radio' && state[input.name] !== undefined) { // –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ä–∞–¥–∏–æ–∫–Ω–æ–ø–æ–∫
                        input.checked = (state[input.name] === input.value);
                    }
                });
            }
        }
        
        // --- –õ–æ–≥–∏–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è (–ò–°–ü–†–ê–í–õ–ï–ù–û) ---
        copyButton.addEventListener('click', () => {
            let reportText = "üìù –ê–Ω–∫–µ—Ç–∞ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–æ–π –∏—Å—Ç–æ—Ä–∏–∏\n\n";

            const getInputValue = id => document.getElementById(id).value.trim();
            const getRadioValue = name => {
                const checkedRadio = form.querySelector(`input[name="${name}"]:checked`);
                return checkedRadio ? checkedRadio.value : "–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞";
            };

            // –ë–ª–æ–∫ 1: –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
            reportText += "üë§ –û–ë–©–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø\n";
            reportText += `   –§–ò–û: ${getInputValue('fullName') || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}\n`;
            reportText += `   –î–∞—Ç–∞: ${getInputValue('date') || '–ù–µ —É–∫–∞–∑–∞–Ω–∞'}\n\n`;

            // –ë–ª–æ–∫ 2: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è
            const checkedConditions = conditions
                .filter(c => document.getElementById(c.id).checked)
                .map(c => `   - ${c.text}`);
            if (checkedConditions.length > 0) {
                reportText += 'ü©∫ –ü–ï–†–°–û–ù–ê–õ–¨–ù–ê–Ø –ú–ï–î–ò–¶–ò–ù–°–ö–ê–Ø –ò–°–¢–û–†–ò–Ø (–û—Ç–º–µ—á–µ–Ω–æ "–î–∞")\n';
                reportText += checkedConditions.join('\n') + '\n\n';
            }

            // –ë–ª–æ–∫ 3: –û–±–∑–æ—Ä —Å–∏–º–ø—Ç–æ–º–æ–≤
            const checkedSymptoms = symptoms
                .filter(s => document.getElementById(s.id).checked)
                .map(s => `   - ${s.text}`);
            if (checkedSymptoms.length > 0) {
                reportText += 'üå°Ô∏è –û–ë–ó–û–† –°–ò–ú–ü–¢–û–ú–û–í (–û—Ç–º–µ—á–µ–Ω–æ "–î–∞")\n';
                reportText += checkedSymptoms.join('\n') + '\n\n';
            }

            // –ë–ª–æ–∫ 4: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã
            reportText += "üß¨ –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–´–ï –í–û–ü–†–û–°–´ –û –ó–î–û–†–û–í–¨–ï –ò –°–¢–ò–õ–ï –ñ–ò–ó–ù–ò\n";
            reportText += `91. –ü—Ä–∏–Ω–∏–º–∞–µ—Ç–µ –ª–µ–∫–∞—Ä—Å—Ç–≤–∞: ${getRadioValue('medication')}\n`;
            reportText += `92. –•–∏—Ä—É—Ä–≥–∏—á–µ—Å–∫–∏–µ –≤–º–µ—à–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 –ª–µ—Ç: ${getRadioValue('surgery')}\n`;
            reportText += `93. –ë–æ–ª–µ–∑–Ω—å —Å–µ—Ä–¥—Ü–∞ –≤ —Å–µ–º—å–µ (–¥–æ 60 –ª–µ—Ç): ${getRadioValue('family_heart_disease')}\n`;
            reportText += `94. –ë–æ–ª–µ–∑–Ω–∏ –≤ —Å–µ–º—å–µ: ${getRadioValue('family_illness')}\n`;
            reportText += `95. –ü—Ä–æ—Å—Ç—É–¥–∞/–∫–∞—à–µ–ª—å –≤ –Ω–∞—Å—Ç–æ—è—â–µ–µ –≤—Ä–µ–º—è: ${getRadioValue('cold_cough')}\n`;
            reportText += `96. –ë—ã–ª–∏ –≥–æ—Å–ø–∏—Ç–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã: ${getRadioValue('hospitalized')}\n`;
            reportText += `97. –ù–∞ —É—á–µ—Ç–µ —É –≤—Ä–∞—á–∞: ${getRadioValue('doctor_care')}\n`;
            reportText += `98. –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Ä–æ–¥–∏–Ω–∫–∞—Ö: ${getRadioValue('mole_change')}\n`;
            reportText += `99. –ë–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–∞ –æ –∑–¥–æ—Ä–æ–≤—å–µ: ${getRadioValue('health_concerns')}\n`;
            
            const smokingNow = getRadioValue('smoking_now');
            reportText += `100. –ö—É—Ä–∏—Ç–µ –≤ –Ω–∞—Å—Ç–æ—è—â–∏–π –º–æ–º–µ–Ω—Ç: ${smokingNow}`;
            if (smokingNow === '–î–∞') {
                reportText += ` (–°–∏–≥–∞—Ä–µ—Ç –≤ –¥–µ–Ω—å: ${getInputValue('cigarettes_per_day') || '–Ω–µ —É–∫–∞–∑.'}, –°—Ç–∞–∂: ${getInputValue('smoking_duration_now') || '–Ω–µ —É–∫–∞–∑.'})\n`;
            } else { reportText += '\n'; }
            
            const smokedEver = getRadioValue('smoked_ever');
            reportText += `101. –ö—É—Ä–∏–ª–∏ –∫–æ–≥–¥–∞-–ª–∏–±–æ –≤ –∂–∏–∑–Ω–∏: ${smokedEver}`;
            if (smokedEver === '–î–∞') {
                reportText += ` (–°—Ç–∞–∂: ${getInputValue('smoking_duration_past') || '–Ω–µ —É–∫–∞–∑.'}, –°–∏–≥–∞—Ä–µ—Ç/–¥–µ–Ω—å: ${getInputValue('cigarettes_per_day_past') || '–Ω–µ —É–∫–∞–∑.'}, –ë—Ä–æ—Å–∏–ª–∏: ${getInputValue('quit_date') || '–Ω–µ —É–∫–∞–∑.'})\n`;
            } else { reportText += '\n'; }
            
            reportText += `102. –î—Ä—É–≥–∏–µ —Ñ–æ—Ä–º—ã —Ç–∞–±–∞–∫–∞/–Ω–∏–∫–æ—Ç–∏–Ω–∞ –∑–∞ 15 –ª–µ—Ç: ${getRadioValue('other_tobacco')}\n`;
            
            const drinksAlcohol = getRadioValue('alcohol');
            reportText += `103. –£–ø–æ—Ç—Ä–µ–±–ª—è–µ—Ç–µ –∞–ª–∫–æ–≥–æ–ª—å: ${drinksAlcohol}`;
            if (drinksAlcohol === '–î–∞') {
                reportText += ` (–ö–æ–ª-–≤–æ: ${getInputValue('alcohol_amount') || '–Ω–µ —É–∫–∞–∑.'} –ª/–Ω–µ–¥., –î–Ω–∏: ${getInputValue('alcohol_days') || '–Ω–µ —É–∫–∞–∑.'})\n`;
            } else { reportText += '\n'; }
            
            reportText += `104. –°–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–∂–∏: ${getRadioValue('skin_condition') === '–î–∞' ? '–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ' : '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ'}\n`;
            reportText += `105. –°–æ—Å—Ç–æ—è–Ω–∏–µ –Ω–æ–≥—Ç–µ–π: ${getRadioValue('nail_condition') === '–î–∞' ? '–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ' : '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ'}\n`;
            reportText += `106. –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–æ–ª–æ—Å: ${getRadioValue('hair_condition') === '–î–∞' ? '–ù–µ—É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ' : '–£–¥–æ–≤–ª–µ—Ç–≤–æ—Ä–∏—Ç–µ–ª—å–Ω–æ–µ'}\n`;
            
            reportText += "107. –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è:\n";
            reportText += `    - –•–æ–ª–µ—Å—Ç–µ—Ä–∏–Ω: ${getInputValue('cholesterol_date') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}, –†–µ–∑—É–ª—å—Ç–∞—Ç: ${getInputValue('cholesterol_result') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
            reportText += `    - –ì–µ–º–∞—Ç–æ–∫—Ä–∏—Ç: ${getInputValue('hematocrit_date') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}, –†–µ–∑—É–ª—å—Ç–∞—Ç: ${getInputValue('hematocrit_result') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
            reportText += `    - –ì–µ–º–æ–≥–ª–æ–±–∏–Ω: ${getInputValue('hemoglobin_date') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}, –†–µ–∑—É–ª—å—Ç–∞—Ç: ${getInputValue('hemoglobin_result') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
            reportText += `    - –ì–ª—é–∫–æ–∑–∞: ${getInputValue('glucose_date') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}, –†–µ–∑—É–ª—å—Ç–∞—Ç: ${getInputValue('glucose_result') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
            reportText += `    - –ò–Ω—Å—É–ª–∏–Ω: ${getInputValue('insulin_date') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}, –†–µ–∑—É–ª—å—Ç–∞—Ç: ${getInputValue('insulin_result') || '–Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö'}\n`;
            
            reportText += `108. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∏—â–µ–≤–∞—Ä–µ–Ω–∏–µ–º (—Ç—è–∂–µ—Å—Ç—å, –≤–∑–¥—É—Ç–∏–µ): ${getRadioValue('digestion_issues')}\n`;
            reportText += `109. –†–∞–±–æ—Ç–∞ —Å–≤—è–∑–∞–Ω–∞ —Å —Ö–∏–º./—à—É–º–æ–º/–ø—ã–ª—å—é: ${getRadioValue('work_hazards')}\n`;
            reportText += `110. –•–∞—Ä–∞–∫—Ç–µ—Ä —Ä–∞—Ü–∏–æ–Ω–∞: ${getRadioValue('diet_type')}\n\n`;

            // –ë–ª–æ–∫ 5: –ü–æ—è—Å–Ω–µ–Ω–∏—è
            reportText += "üîç –ü–û–Ø–°–ù–ï–ù–ò–Ø –ö –û–¢–í–ï–¢–ê–ú ¬´–î–ê¬ª\n";
            let detailsAdded = false;
            for(let i = 1; i <= 10; i++) {
                const qNum = getInputValue(`detail_q_${i}`);
                const qText = getInputValue(`detail_text_${i}`);
                if (qNum && qText) {
                    reportText += `   - –í–æ–ø—Ä–æ—Å ‚Ññ${qNum}: ${qText}\n`;
                    detailsAdded = true;
                }
            }
            const extraExplanations = getInputValue('explanations_extra');
            if (extraExplanations) {
                reportText += `\n   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ—è—Å–Ω–µ–Ω–∏—è:\n   ${extraExplanations}\n`;
                detailsAdded = true;
            }
            if (!detailsAdded) {
                reportText += "   (–ü–æ—è—Å–Ω–µ–Ω–∏–π –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω–æ)\n";
            }
            
            // –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –∏ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ
            copyContainer.classList.remove('hidden');
            reportOutput.value = reportText;
            reportOutput.select();
            reportOutput.setSelectionRange(0, 99999); // –î–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤

            // –ü–æ–ø—ã—Ç–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
            try {
                document.execCommand('copy');
                copyButton.textContent = '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
            } catch (err) {
                copyButton.textContent = '‚úÖ –ù–∞–∂–º–∏—Ç–µ Ctrl+C –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è';
            }

            setTimeout(() => {
                copyButton.textContent = '–°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∏ —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–≤–µ—Ç—ã';
            }, 3000);
        });

        // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---
        allInputs().forEach(input => {
            input.addEventListener('change', saveState);
            input.addEventListener('input', saveState);
        });

        generateCheckboxes('conditions-grid', conditions);
        generateCheckboxes('symptoms-grid', symptoms);
        generateLifestyleQuestions();
        generateDetailsFields();
        
        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â—É—é –¥–∞—Ç—É, –µ—Å–ª–∏ –ø–æ–ª–µ –ø—É—Å—Ç–æ–µ
        if (!document.getElementById('date').value) {
            document.getElementById('date').valueAsDate = new Date();
        }
        
        loadState();
    });
</script>
